PREFIX knora-api: <http://api.knora.org/ontology/knora-api/simple/v2#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX webern: <http://0.0.0.0:3333/ontology/08AE/webern/simple/v2#>

CONSTRUCT {
    ?CompWork knora-api:isMainResource true .
    ?CompWork webern:R40_hasRepresentativeExpression ?expression .
    ?expression ?exprLinkingProp ?statement .
    ?statement ?stateLinkingProp ?stateValue .
} WHERE {

    ?CompWork a knora-api:Resource, webern:F15_ComplexWork .
    ?CompWork webern:R40_hasRepresentativeExpression ?expression .
    webern:R40_hasRepresentativeExpression knora-api:objectType knora-api:Resource .

    ?expression a knora-api:Resource, webern:F22_SelfContainedExpression .
    ?expression ?exprLinkingProp ?statement .

    ?statement a knora-api:Resource .

    ?exprLinkingProp knora-api:objectType knora-api:Resource .

    FILTER(?exprLinkingProp = webern:U17_hasOpusStatement)

    ?statement ?stateLinkingProp ?stateValue .
    ?stateLinkingProp knora-api:objectType xsd:string .
    ?stateValue a xsd:string .


}
