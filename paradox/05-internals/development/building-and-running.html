<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../../cloud">
<title>Building and Running Â· Knora Documentation</title>
<link rel="stylesheet" href="../../assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
<link rel="stylesheet" href="../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../lib/prettify/prettify.css">
<script src="../../lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../../assets/stylesheets/paradox-material-theme.css">
</head>
<body
data-md-color-primary="blue"
data-md-color-accent="yellow"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../index.html" title="Knora Documentation" class="md-header-nav__button md-logo">
<i class="md-icon">cloud</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Knora Documentation
</span>
<span class="md-header-nav__topic">
Building and Running
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/dhlab-basel/Knora/docs"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
dhlab-basel/Knora/docs
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">cloud</i>
</span>
<a href="../../index.html" title="Knora Documentation">
Knora Documentation
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/dhlab-basel/Knora/docs"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
dhlab-basel/Knora/docs
</div>
</a>

</div>
<ul>
  <li><a href="../../01-introduction/index.html" class="page">Introduction</a>
  <ul>
    <li><a href="../../01-introduction/what-is-knora.html" class="page">What Is Knora?</a></li>
    <li><a href="../../01-introduction/data-formats.html" class="page">Data Formats in Knora</a></li>
    <li><a href="../../01-introduction/standoff-rdf.html" class="page">Standoff/RDF Text Markup</a></li>
    <li><a href="../../01-introduction/example-project.html" class="page">An Example Project</a></li>
  </ul></li>
  <li><a href="../../02-knora-ontologies/index.html" class="page">Knora Ontologies</a>
  <ul>
    <li><a href="../../02-knora-ontologies/introduction.html" class="page">Introduction</a></li>
    <li><a href="../../02-knora-ontologies/knora-base.html" class="page">The Knora Base Ontology</a></li>
    <li><a href="../../02-knora-ontologies/salsah-gui.html" class="page">The SALSAH GUI Ontology</a></li>
  </ul></li>
  <li><a href="../../03-apis/index.html" class="page">The Knora APIs</a>
  <ul>
    <li><a href="../../03-apis/api-v1/index.html" class="page">Knora API v1</a></li>
    <li><a href="../../03-apis/api-v2/index.html" class="page">Knora API v2</a></li>
    <li><a href="../../03-apis/api-admin/index.html" class="page">Knora Admin API</a></li>
  </ul></li>
  <li><a href="../../04-publishing-deployment/index.html" class="page">Deploying Knora</a>
  <ul>
    <li><a href="../../04-publishing-deployment/publishing.html" class="page">Publishing</a></li>
    <li><a href="../../04-publishing-deployment/getting-started.html" class="page">Getting Started with Knora</a></li>
    <li><a href="../../04-publishing-deployment/configuration.html" class="page">Configuration</a></li>
    <li><a href="../../04-publishing-deployment/updates.html" class="page">Updating Repositories When Upgrading Knora</a></li>
  </ul></li>
  <li><a href="../../05-internals/index.html" class="page">Knora Internals</a>
  <ul>
    <li><a href="../../05-internals/design/index.html" class="page">Design</a></li>
    <li><a href="../../05-internals/development/index.html" class="page">Development</a></li>
  </ul></li>
  <li><a href="../../06-salsah/index.html" class="page">The SALSAH 1 GUI</a></li>
  <li><a href="../../07-sipi/index.html" class="page">The Sipi Media Server</a>
  <ul>
    <li><a href="../../07-sipi/setup-sipi-for-knora.html" class="page">Setting Up Sipi for Knora</a></li>
    <li><a href="../../07-sipi/sipi-and-knora.html" class="page">Interaction Between Sipi and Knora</a></li>
  </ul></li>
  <li><a href="../../faq.html" class="page">Frequently Asked Questions</a></li>
  <li><a href="../../00-release-notes/index.html" class="page">Release Notes</a>
  <ul>
    <li><a href="../../00-release-notes/v1.1.0.html" class="page">v1.1.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.2.0.html" class="page">v1.2.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.3.0.html" class="page">v1.3.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.4.0.html" class="page">v1.4.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.5.0.html" class="page">v1.5.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.6.0.html" class="page">v1.6.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.7.0.html" class="page">v1.7.x Release Notes</a></li>
    <li><a href="../../00-release-notes/v2.x.x.html" class="page">v2.x.x Release Notes</a></li>
    <li><a href="../../00-release-notes/v3.x.x.html" class="page">v3.x.x Release Notes</a></li>
    <li><a href="../../00-release-notes/v4.x.x.html" class="page">v4.x.x Release Notes</a></li>
    <li><a href="../../00-release-notes/v5.x.x.html" class="page">v5.x.x Release Notes</a></li>
    <li><a href="../../00-release-notes/v6.x.x.html" class="page">v6.x.x Release Notes</a></li>
    <li><a href="../../00-release-notes/next.html" class="page">Release Notes for Next Release</a></li>
    <li><a href="../../00-release-notes/migration.html" class="page">Migration Notes</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../../05-internals/development/building-and-running.html#building-and-running" class="header">Building and Running</a>
  <ul>
    <li><a href="../../05-internals/development/building-and-running.html#starting-a-triplestore" class="header">Starting a Triplestore</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#running-the-automated-tests" class="header">Running the automated tests</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#load-testing-on-mac-os-x" class="header">Load Testing on Mac OS X</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#continuous-integration" class="header">Continuous Integration</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#webapi-server-startup-flags" class="header">Webapi Server Startup-Flags</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 8.1.0-12-g739492f*
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../../05-internals/development/building-and-running.html#building-and-running" class="header">Building and Running</a>
  <ul>
    <li><a href="../../05-internals/development/building-and-running.html#starting-a-triplestore" class="header">Starting a Triplestore</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#running-the-automated-tests" class="header">Running the automated tests</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#load-testing-on-mac-os-x" class="header">Load Testing on Mac OS X</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#continuous-integration" class="header">Continuous Integration</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#webapi-server-startup-flags" class="header">Webapi Server Startup-Flags</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<!---
Copyright Â© 2015-2019 the contributors (see Contributors.md).

This file is part of Knora.

Knora is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Knora is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public
License along with Knora.  If not, see <http://www.gnu.org/licenses/>.
-->
<h1><a href="#building-and-running" name="building-and-running" class="anchor"><span class="anchor-link"></span></a>Building and Running</h1>
<div class="toc ">
<ul>
  <li><a href="../../05-internals/development/building-and-running.html#starting-a-triplestore" class="header">Starting a Triplestore</a></li>
  <li><a href="../../05-internals/development/building-and-running.html#running-the-automated-tests" class="header">Running the automated tests</a></li>
  <li><a href="../../05-internals/development/building-and-running.html#load-testing-on-mac-os-x" class="header">Load Testing on Mac OS X</a></li>
  <li><a href="../../05-internals/development/building-and-running.html#continuous-integration" class="header">Continuous Integration</a></li>
  <li><a href="../../05-internals/development/building-and-running.html#webapi-server-startup-flags" class="header">Webapi Server Startup-Flags</a>
  <ul>
    <li><a href="../../05-internals/development/building-and-running.html#loaddemodata-flag" class="header"><code>loadDemoData</code> - Flag</a></li>
    <li><a href="../../05-internals/development/building-and-running.html#allowreloadoverhttp-flag" class="header"><code>allowReloadOverHTTP</code> - Flag</a></li>
  </ul></li>
</ul>
</div>
<h2><a href="#starting-a-triplestore" name="starting-a-triplestore" class="anchor"><span class="anchor-link"></span></a>Starting a Triplestore</h2>
<p>Start a triplestore (GraphDB-Free or GraphDB-SE). Download distribution from <a href="http://ontotext.com">Ontotext</a>. Unzip distribution to a place of your choosing and run the following:</p>
<pre><code>$ cd /to/unziped/location
$ ./bin/graphdb -Dgraphdb.license.file=/path/to/GRAPHDB_SE.license
</code></pre>
<p>Here we use GraphDB-SE which needs to be licensed separately.</p>
<p>Then in another terminal, initialize the data repository and load some test data:</p>
<pre><code>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./graphdb-se-local-init-knora-test.sh
</code></pre>
<p>Then in another terminal, start the <a href="https://redis.io">Redis Server</a>:</p>
<pre class="prettyprint"><code class="language-bash">$ redis-server
</code></pre>
<p>Then go back to the webapi root directory and use SBT to start the API server:</p>
<pre><code>$ cd KNORA_PROJECT_DIRECTORY
$ sbt
&gt; webapi / compile
&gt; webapi / reStart
</code></pre>
<p>To shut down Knora:</p>
<pre><code>&gt; webapi / reStop
</code></pre>
<h2><a href="#running-the-automated-tests" name="running-the-automated-tests" class="anchor"><span class="anchor-link"></span></a>Running the automated tests</h2>
<p>Make sure you&rsquo;ve started the triplestore as shown above.</p>
<p>Then in another terminal, initialise the repository used for automated testing:</p>
<pre><code>$ cd KNORA_PROJECT_DIRECTORY/webapi/scripts
$ ./graphdb-se-local-init-knora-test-unit.sh
</code></pre>
<p>Run the automated tests from sbt:</p>
<pre><code>&gt; webapi / graphdb:test
</code></pre>
<h2><a href="#load-testing-on-mac-os-x" name="load-testing-on-mac-os-x" class="anchor"><span class="anchor-link"></span></a>Load Testing on Mac OS X</h2>
<p>To test Knora with many concurrent connections on Mac OS X, you will need to adjust some kernel parameters to allow more open connections, to recycle ephemeral ports more quickly, and to use a wider range of ephemeral port numbers. The script <code>webapi/scripts/macOS-kernel-test-config.sh</code> will do this.</p>
<h2><a href="#continuous-integration" name="continuous-integration" class="anchor"><span class="anchor-link"></span></a>Continuous Integration</h2>
<p>For continuous integration testing, we use Travis-CI. Every commit pushed to the git repository or every pull request, triggers the build. Additionaly, in Github there is a litle checkmark beside every commit, signaling the status of the build (successful, unsucessful, ongoing).</p>
<p>The build that is executed on Travis-CI is defined in <code>.travis.yml</code> situated in the root folder of the project, and looks like this:</p>
<pre class="prettyprint"><code class="language-yml">dist: xenial

sudo: required

addons:
  chrome: stable

language:
  - &quot;scala&quot;
  - &quot;python&quot;

scala:
  - &quot;2.12.1&quot;

python:
  - &quot;3.7&quot;

jdk:
  - openjdk10

services:
  - docker
  - redis-server

env:
  global:
  - secure: Sj0D8wR3Vx0J0h+LBUIh9t1PWjLJ2NEiKILf3JO5nuGdlU7dPhbFomR4w08q85O4d60km38ml7zpapC4noDQnbAFQHC6XeOe5CWPYFXCxkw7ueBoxhy/vkfSzypXp0UTNUX3S7+RcGJcTxLaZcUC9u+UaoWB0LMkmOcIlrKIDuzm3HcefMsml8gYX1xhS2TQJ8P7ZerzBmm0kERYLUabhxTnj5WAvue0d1xbUtzCzT1LpignOfsUZ9kHTagQEA15JsU0iNrMCvlDcxRWj8OzLhHRoHui4bJPQQfKEA8oMnTkPyzBRLmqafqHvmGcNQp9iGhuU04gb+FkF4gubBkLrxEvgTL/D5vIin3BHQvnZna9zSnUguZS+jw4sfEYcjZgYRzgMRPma/630ZM08FSZZ/qjSTCut4Cjua5aw2Vf9pYhf+Aad5rR0T2JmVYKp6Ik92aLhPOF9U40MacKRPPT54RIjCYcakZlmU4vl+kK37l3sYjvD57LeSs3PlqvkpSxwJzaQDhZFOZ+c7ICo+zU7DcQnWkN7k+ErKBOE7r0mIqvYuBYhdteBVKfo8a4rpDzYJDXaWzBdjc8ZKiEFQvFHngnZjR2UtKc0CAc6Y7ieCWIvBZYdMoHhKsBwFDaO1iuWwDLW3cswXaPEqENonlVAnXePu7KkQeB2acwDzPkhlI=
  - secure: iM3Wjt3f5yUaU16yKstwBEEFA8WKx8qcTVnOwF+o9+sooD1SZ39nYJDPgpHHNwFZ1aSkre5ATPEw+dfslr7SnnwYQeYHjYldcqudB+7pq4dmY5U3rCTsjZCH1XmLnnLO45CZRy05pIAUSxWpIiX5khWoHZd704UlDncqIU/6paWWNkywPb2P4UBZ5Xeai1NTS1URHRz0A4aD+dqwKS6P+baq4CyKLC/AqjsTDI+TV4C26FXXTgS0Ly9VfBVZ55D+SdVHgCZXJaHerAixjSX6zvenfkd/87GR6NEAgJ9QofF2nDEXBZZm4jPv5d285Cc4iUvRo1HLbI1VlALya3qUA9Prbno8QQaChNdjRS7mSplkCxZZKzBItpjvI009NPl20zX6GROb/JCjWHRZ4R358cebFKKqE4W1GBArS0piVbdqZyWA/t5KANouQIdrh+lepAf/Xq5JRcDP9r+Rk2hHLk2Rmj97gv001eRf9GjSEC1Qo1kwu1FabZok1UIemJHpY7yWO4d3ZKSOCyQ0WdW6rLMFGkouoByrFVfNPBVxLqDJ3YVL/4x5jc0Q9+G5jm6omqNwQSsn60nUizZJp1fuLGQRUNj8EDvRhxLgVkOJqFf4P/4qRas47k1wkWBk2iBlpNp2eQTY42IZovPIyT+NCfbdg0yyZRyHThpfc+KfTeg=
  - WEBAPI_REPO=dhlabbasel/webapi
  - SALSAH1_REPO=dhlabbasel/salsah1
  - SALSAH2_REPO=dhlabbasel/salsah2
  - SIPI_REPO=dhlabbasel/sipi
  - DOCKERHOST=$(ip route get 8.8.8.8 | awk &#39;{print $NF; exit}&#39;)
  - CHROME_BIN=google-chrome-stable
  - GDB_HEAP_SIZE=&quot;2G&quot;
  - TAG=${TRAVIS_BRANCH//\//-}
  - GRAPHDB_VERSION=&quot;8.5.0-se&quot;

before_cache:
  - sudo chown -R travis:travis $HOME/.ivy2

cache:
  directories:
  - &quot;$HOME/.ivy2&quot;
before_install:
  - openssl aes-256-cbc -K $encrypted_ec8f5e0fa991_key -iv $encrypted_ec8f5e0fa991_iv -in travis/secrets.tar.enc -out $TRAVIS_BUILD_DIR/travis/secrets.tar -d
  - tar -C travis -xvf travis/secrets.tar
  - sudo apt-get -qq update
  - sudo apt-get install -y expect

stages:
  - compile and stage
  - test
  - name: publish # generally, only publish if we are on &#39;develop&#39; or tagged
    if: branch = develop OR tag IS present

jobs:
  include:
    # test sbt compile and stage
    - stage: compile and stage
      script:
        - rm -rf $HOME/.sbt
        - rm -rf $HOME/.ivy2
        - cd $TRAVIS_BUILD_DIR &amp;&amp; sbt clean stage
        # only uncomment if docker image is needed for this branch. remove before merging into develop
        # - docker login -u $DOCKER_USER -p $DOCKER_PASS
        # - sbt webapi/docker:publish
        # - sbt salsah1/docker:publish
        # - sbt knora-sipi/docker:publish
        # - sbt knora-graphdb-se/docker:publish
        # - sbt knora-graphdb-free/docker:publish
        # - sbt knora-upgrade/docker:publish
        # - sbt knora-assets/docker:publish
    # unit tests
    - stage: test
      script:
        # prepare needed graphdb-se files
        - mkdir -p $TRAVIS_BUILD_DIR/graphdb
        - cp $TRAVIS_BUILD_DIR/travis/graphdb.license $TRAVIS_BUILD_DIR/graphdb/graphdb.license
        - cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb
        # start and initialize graphdb-se
        - docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/graphdb:/graphdb -e GDB_HEAP_SIZE=$GDB_HEAP_SIZE ontotext/graphdb:$GRAPHDB_VERSION -Dgraphdb.license.file=/graphdb/graphdb.license
        - sleep 15
        - cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test-unit.sh
        # hit graphdb with a request &quot;waking-it-up&quot;
        - curl http://localhost:7200/rest/repositories
        # start the built-in webapi server tests
        - cd $TRAVIS_BUILD_DIR/ &amp;&amp; sbt webapi/clean coverage &#39;webapi/testOnly -- -l org.knora.webapi.testing.tags.E2ETest&#39; webapi/coverageReport
        # upload code coverage report
        # - sbt codacyCoverage
    # e2e tests
    - stage: test
      script:
        # prepare needed graphdb-se files
        - mkdir -p $TRAVIS_BUILD_DIR/graphdb
        - cp $TRAVIS_BUILD_DIR/travis/graphdb.license $TRAVIS_BUILD_DIR/graphdb/graphdb.license
        - cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb
        # start and initialize graphdb-se
        - docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/graphdb:/graphdb -e GDB_HEAP_SIZE=$GDB_HEAP_SIZE ontotext/graphdb:$GRAPHDB_VERSION -Dgraphdb.license.file=/graphdb/graphdb.license
        - sleep 15
        - cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test-unit.sh
        # hit graphdb with a request &quot;waking-it-up&quot;
        - curl http://localhost:7200/rest/repositories
        # start the built-in webapi server tests
        - cd $TRAVIS_BUILD_DIR/ &amp;&amp; sbt webapi/clean coverage &#39;webapi/testOnly -- -n org.knora.webapi.testing.tags.E2ETest&#39; webapi/coverageReport
        # upload code coverage report
        # - sbt codacyCoverage
    # integration tests
    - stage: test
      script:
        # prepare needed graphdb-se files
        - mkdir -p $TRAVIS_BUILD_DIR/graphdb
        - cp $TRAVIS_BUILD_DIR/travis/graphdb.license $TRAVIS_BUILD_DIR/graphdb/graphdb.license
        - cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb
        # start and initialize graphdb-se
        - docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/graphdb:/graphdb -e GDB_HEAP_SIZE=$GDB_HEAP_SIZE ontotext/graphdb:$GRAPHDB_VERSION -Dgraphdb.license.file=/graphdb/graphdb.license
        - sleep 15
        - cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test-unit.sh
        # start the sipi container (with production config)
        - cd $TRAVIS_BUILD_DIR/sipi/ &amp;&amp; docker-compose up -d sipi-it
        # start the integration tests
        - cd $TRAVIS_BUILD_DIR/ &amp;&amp; sbt webapi/clean coverage webapi/it:test webapi/coverageReport
        # upload code coverage report
        # - sbt codacyCoverage
        # print out Sipi logs
        - cd $TRAVIS_BUILD_DIR/sipi/ &amp;&amp; docker-compose logs
    # upgrade tests
    - stage: test
      script:
        # run tests
        - pyenv shell 3.7.1
        - cd $TRAVIS_BUILD_DIR/upgrade &amp;&amp; pip3 install -r requirements.txt &amp;&amp; ./test.sh
    # testing docs generation
    #- stage: test
    #  script:
    #    # install the necessary packages
    #    - sudo apt-get install -y graphviz software-properties-common
    #    - sudo apt-add-repository -y ppa:rael-gc/rvm
    #    - sudo apt-get update
    #    - sudo apt-get --allow-unauthenticated install rvm
    #    - rvm reload
    #    - rvm install ruby 2.5.1
    #    - rvm use 2.5.1 --default
    #    - ruby -v
    #    # install bundler
    #    - gem install bundler
    #    # install jekyll
    #    # - gem install jekyll -v 3.8.1
    #    # install typedoc
    #    - npm i npm@latest -g
    #    - npm install --global typedoc
    #    # install jekyll dependencies
    #    - cd $TRAVIS_BUILD_DIR/docs/src/jekyll &amp;&amp; bundle install
    #    # compile and build all docs (paradox, typescript, jekyll)
    #    - cd $TRAVIS_BUILD_DIR/ &amp;&amp; sbt docs/makeSite
    # Salsah browser tests
    #- stage: test
    #  script:
    #    # prepare needed graphdb-se files
    #    - mkdir -p $TRAVIS_BUILD_DIR/data/conf
    #    - cp $TRAVIS_BUILD_DIR/travis/graphdb.license $TRAVIS_BUILD_DIR/data/conf/graphdb.license
    #    - mkdir -p $TRAVIS_BUILD_DIR/graphdb
    #    - cp $TRAVIS_BUILD_DIR/webapi/scripts/KnoraRules.pie $TRAVIS_BUILD_DIR/graphdb
    #    # start and initialize graphdb-se
    #    - docker run -d -p 127.0.0.1:7200:7200 -v $TRAVIS_BUILD_DIR/data:/opt/graphdb/home -v $TRAVIS_BUILD_DIR/graphdb:/graphdb -e GDB_HEAP_SIZE=$GDB_HEAP_SIZE ontotext/graphdb:$GRAPHDB_VERSION
    #    - sleep 15
    #    - cd $TRAVIS_BUILD_DIR/webapi/scripts &amp;&amp; ./graphdb-se-docker-init-knora-test.sh
    #    # start the sipi container (with test config)
    #    - docker run -d --add-host webapihost:$DOCKERHOST -v /tmp:/tmp -v $HOME:$HOME -p 1024:1024 $SIPI_REPO:develop /sipi/local/bin/sipi --config=/sipi/config/sipi.knora-test-docker-config.lua
    #    # start the webapi and salsah1 server
    #    - cd $TRAVIS_BUILD_DIR/webapi/ &amp;&amp; sbt &quot;run allowReloadOverHTTP&quot; &amp;
    #    - cd $TRAVIS_BUILD_DIR/salsah1/ &amp;&amp; sbt run &amp;
    #    # wait for the webapi server to start before we proceed with running the salsah tests
    #    - until netstat -an 2&gt;/dev/null | grep &#39;3333.*LISTEN&#39;; do true; done
    #    # unzip chromedriver
    #    - cd $TRAVIS_BUILD_DIR/salsah1/lib/chromedriver/ &amp;&amp; unzip chromedriver_linux64.zip
    #    # start built-in salsah1 browser tests
    #    - cd $TRAVIS_BUILD_DIR/salsah1/ &amp;&amp; sbt headless:test
    # testing docker images
    - stage: test
      script:
        - sbt webapi/docker:publishLocal
        - sbt salsah1/docker:publishLocal
        - sbt knora-sipi/docker:publishLocal
        - sbt knora-graphdb-se/docker:publishLocal
        - sbt knora-graphdb-free/docker:publishLocal
        - sbt knora-upgrade/docker:publishLocal
        - sbt knora-assets/docker:publishLocal
    - stage: publish
      script:
        # login into docker hub, build image, and push but only when on the &quot;develop&quot; branch or tagged
        # when on &#39;develop&#39; then $TRAVIS_BRANCH = develop
        # when on &#39;tag&#39; then $TRAVIS_BRANCH = tag, e.g., v1.2.0
        - docker login -u $DOCKER_USER -p $DOCKER_PASS
        # webapi
        - sbt webapi/docker:publish
        # salsah1
        - sbt salsah1/docker:publish
        # knora-sipi
        - sbt knora-sipi/docker:publish
        # knora-graphdb-se
        - sbt knora-graphdb-se/docker:publish
        # knora-graphdb-free
        - sbt knora-graphdb-free/docker:publish
        # knora-upgrade
        - sbt knora-upgrade/docker:publish
        # knora-assets
        - sbt knora-assets/docker:publish

notifications:
  slack:
    secure: gaazomUbAB4q7bH2XOiZXqHvU2gd/X/jIRLAJW9vjcRbY6o48eiEdNXF2umraHG0q+5UUEJ5dfvxiPtC4PiUq8uD6J+R0fEWrWznYoIeEWEXjKxRxWplrWJ9Ke+PJb3wCV6cXBGMfxDpvYQbVjsy7n0aQmjNs4Drz+llqL5SilTdswTylwvUdufad0QaovXklL+p0w9vRHRKzQkYKa9phL10VcJa8TPI74tuFcTHnK6TcMNW6p0vzAaF6JVgzoRPzUgXnEPCw4pI8zqOF1ghPpQByNXKiYofPWt1yTFgb60LQarDEiHXunXAA/sf2gx616pWLVjDFGziXVzhiGUDUjM5I1p7hPyA2rTB63AAZustFcGeD+jbHNHIFhcvvCHVHjJfp8M7LrUR+MBqz5mJNi/9KgxyZ8I9Df28TxmKxGFaGW8t4PZdA75/49Hos0TqtIp5m+eo8mTksUJogEJJokRZUKraMBhC0cNCry0kp+EQ06F4usLoDyZTUar4OSuNSiymf+zwz6jZo8dF/cluRYellwewE9NJiNWGN4DiBhk2vGJ7OtWMDPkl1tqkG8npoqbT4s38esjxfa/XcworGfeqE+9mzugVzkIKIX2lB6QxZp0AKQVOiy7JwwdtcjVMLvceiNPEWfe8fhLMX02oqYz2uoibRmHMxKPa5CpmUIg=</code></pre>
<p>It basically means:</p>
<ul>
  <li>use the virtual machine based environment (line 1)</li>
  <li>checkout git with a shorter history (lines 2-3)</li>
  <li>add scala libraries (lines 4-6)</li>
  <li>add oracle jdk version 8 (lines 7-8)</li>
  <li>cache some directories between builds to make it faster (line  9-11)</li>
  <li>start fuseki and afterwards start all tests (lines 12-14)</li>
  <li>send notification to our slack channel (lines 15-17)</li>
</ul>
<h2><a href="#webapi-server-startup-flags" name="webapi-server-startup-flags" class="anchor"><span class="anchor-link"></span></a>Webapi Server Startup-Flags</h2>
<p>The Webapi-Server can be started with a number of flags. These flags can be supplied either to the <code>reStart</code> or the <code>run</code> command in sbt, e.g.,:</p>
<pre><code>$ sbt
&gt; webapi / reStart flag
</code></pre>
<p>or</p>
<pre><code>$ sbt
&gt; webapi / run flag
</code></pre>
<h3><a href="#loaddemodata-flag" name="loaddemodata-flag" class="anchor"><span class="anchor-link"></span></a><code>loadDemoData</code> - Flag</h3>
<p>When the webapi-server is started with the <code>loadDemoData</code> flag, then at startup, the data which is configured in <code>application.conf</code> under the <code>app.triplestore.rdf-data</code> key is loaded into the triplestore, and any data in the triplestore is removed beforehand.</p>
<p>Usage:</p>
<pre><code>$ sbt
&gt; webapi / reStart loadDemoData
</code></pre>
<h3><a href="#allowreloadoverhttp-flag" name="allowreloadoverhttp-flag" class="anchor"><span class="anchor-link"></span></a><code>allowReloadOverHTTP</code> - Flag</h3>
<p>When the webapi.server is started with the <code>allowReloadOverHTTP</code> flag (<code>reStart -r</code>), then the <code>v1/store/ResetTriplestoreContent</code> route is activated. This route accepts a <code>POST</code> request, with a JSON payload consisting of the following example content:</p>
<pre><code>[
  {
    &quot;path&quot;: &quot;../knora-ontologies/knora-base.ttl&quot;,
    &quot;name&quot;: &quot;http://www.knora.org/ontology/knora-base&quot;
  },
  {
    &quot;path&quot;: &quot;../knora-ontologies/salsah-gui.ttl&quot;,
    &quot;name&quot;: &quot;http://www.knora.org/ontology/salsah-gui&quot;
  },
  {
    &quot;path&quot;: &quot;_test_data/ontologies/incunabula-onto.ttl&quot;,
    &quot;name&quot;: &quot;http://www.knora.org/ontology/0803/incunabula&quot;
  },
  {
    &quot;path&quot;: &quot;_test_data/all_data/incunabula-data.ttl&quot;,
    &quot;name&quot;: &quot;http://www.knora.org/data/incunabula&quot;
  }
]
</code></pre>
<p>This content corresponds to the payload sent with the <code>ResetTriplestoreContent</code> message, defined inside the <code>org.knora.webapi.messages.v1.store.triplestoremessages</code> package. The <code>path</code> being the relative path to the <code>ttl</code> file which will be loaded into a named graph by the name of <code>name</code>.</p>
<p>Usage:</p>
<pre><code>$ sbt
&gt; webapi / reStart allowReloadOverHTTP
</code></pre>
</div>
<div>
<a href="https://github.com/dhlab-basel/Knora/tree/master/docs/src/paradox/05-internals/development/building-and-running.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
8.1.0-12-g739492f*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../../05-internals/development/graphdb.html" title="Starting GraphDB" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Starting GraphDB
</span>
</div>
</a>
<a href="../../05-internals/development/build-process.html" title="Build Process" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Build Process
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Copyright 2015-2019 the contributors (see Contributors.md)
</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
<a href="https://github.com/dhlab-basel" class="md-footer-social__link fa fa-github"></a><a href="https://twitter.com/dhlabbasel" class="md-footer-social__link fa fa-twitter"></a>
</div>

</div>
</div>
</footer>

</div>
<script src="../../assets/javascripts/application.5165553b.js"></script>
<script src="../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../."}})</script>
<script type="text/javascript" src="../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
